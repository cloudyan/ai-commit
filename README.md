# ai-commit

ç”¨ AI è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒçš„ Git æäº¤ä¿¡æ¯ï¼Œæ”¯æŒ OpenAI/Claude/DeepSeek ç­‰ä»»æ„å…¼å®¹æ¥å£ï¼Œå¹¶è‡ªå¸¦ã€ŒA/B å¯¹æ¯” + è‡ªåŠ¨åŒ–è¯„ä¼°ã€æµæ°´çº¿ã€‚

---

## âœ¨ ç‰¹æ€§

- ğŸš€ **ä¸€é”®ç”Ÿæˆ**ï¼šè¯»å– `git diff --cached`ï¼Œè¾“å‡ºå¯ç›´æ¥ `git commit -F` ä½¿ç”¨çš„æ¶ˆæ¯
- ğŸ”Œ **æ¨¡å‹å³æ¢**ï¼šåŸºäº `ai-sdk`ï¼Œé»˜è®¤ OpenAIï¼Œä¸€è¡Œä»£ç åˆ‡ Claude / DeepSeek
- ğŸ“Š **è‡ªåŠ¨è¯„ä¼°**ï¼šå†…ç½®æ•°æ®é›† + è¯„åˆ†è„šæœ¬ï¼Œæ”¯æŒã€ŒåŒä¸€æ¨¡å‹ä¸åŒ promptã€æˆ–ã€ŒåŒä¸€ prompt ä¸åŒæ¨¡å‹ã€A/B å¯¹æ¯”
- ğŸ¯ **å¯è§£é‡Š**ï¼šæ¯æ¡ç”Ÿæˆç»“æœé™„å¸¦è‡ªè¯„åˆ†æ•°ä¸ç†ç”±ï¼Œæ–¹ä¾¿è¿­ä»£ prompt
- ğŸ›¡ï¸ **å®‰å…¨å…œåº•**ï¼šæ­£åˆ™æ‰«æå¯†é’¥ï¼Œé˜²æ­¢æŠŠ `sk-***` å†™è¿›æäº¤ä¿¡æ¯

---

## ğŸ“¦ å®‰è£… & é…ç½®

```bash
# å…‹éš†
git clone https://github.com/yourname/ai-commit.git
cd ai-commit

# å®‰è£…ä¾èµ–
npm install

# é…ç½®å¯†é’¥
cp .env.example .env
# ç¼–è¾‘ .env
OPENAI_API_KEY=sk-xxx
# å¦‚éœ€ Claudeï¼Œå†å†™ ANTHROPIC_API_KEY=sk-ant-xxx
```

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

1. æš‚å­˜ä½ çš„æ”¹åŠ¨
   ```bash
   git add .
   ```

2. ç”Ÿæˆæäº¤ä¿¡æ¯
   ```bash
   npm run dev
   # æˆ–æŒ‡å®šæ¨¡å‹ / prompt ç‰ˆæœ¬
   npm run dev -- --model gpt-4o --prompt B
   ```

3. ä¸€é”®æäº¤ï¼ˆè‹¥æ»¡æ„ï¼‰
   ```bash
   npm run dev | git commit -F -
   ```

---

## ğŸ§ª è¯„ä¼° & A/B å¯¹æ¯”

å†…ç½® 50 æ¡ä¸­æ–‡/è‹±æ–‡æ··åˆè¯„æµ‹æ•°æ®ï¼Œ3 ç§’è·‘å®Œï¼š

```bash
# å•æ¨¡å‹å• prompt è¯„åˆ†
npm run eval

# è‡ªåŠ¨å¯¹æ¯”æ‰€æœ‰ç»„åˆï¼Œé€‰å‡ºæœ€ä¼˜
npm run eval:compare
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
â”Œ---------â”¬-----------â”¬-----------â”¬--------â”¬----------â”¬--------â”
â”‚ (index) â”‚  model    â”‚ promptVer â”‚ style  â”‚ semantic â”‚ safety â”‚
â”œ---------â”¼-----------â”¼-----------â”¼--------â”¼----------â”¼--------â”¤
â”‚    0    â”‚ 'gpt-3.5' â”‚    'A'    â”‚  0.92  â”‚   0.76   â”‚   1    â”‚
â”‚    1    â”‚ 'gpt-4o'  â”‚    'A'    â”‚  0.94  â”‚   0.82   â”‚   1    â”‚
â””---------â”´-----------â”´-----------â”´--------â”´----------â”´--------â”˜
ğŸ† Best combo: gpt-4o + promptA
```

---

## ğŸ“ è‡ªå®šä¹‰ Prompt & æ¨¡å‹

1. ç¼–è¾‘ `src/prompt.ts` æ–°å¢ç‰ˆæœ¬ `C`ã€`D` â€¦
2. åœ¨ `src/generate.ts` é‡Œåˆ‡æ¢æ¨¡å‹ï¼š

```typescript
// é»˜è®¤
model: openai('gpt-4o')
// æ¢ Claude
model: anthropic('claude-3-sonnet-20240229')
// æ¢ DeepSeek
model: openai('deepseek-chat', {
  baseURL: 'https://api.deepseek.com/v1',
})
```

---

## ğŸ” è¯„åˆ†è§„åˆ™

| ç»´åº¦ | æƒé‡ | é€šè¿‡æ ‡å‡† |
| ---- | ---- | -------- |
| **Style** | 40 % | ç¬¦åˆ Conventional Commits ç±»å‹ + 50 å­—ç¬¦å†… + å‘½ä»¤å¼ |
| **Semantic** | 30 % | ä¸äººå·¥å‚è€ƒå¥ embedding ä½™å¼¦ â‰¥ 0.82 |
| **Concise** | 20 % | æ— å†—ä½™è¯ï¼ˆUpdated/Modifiedï¼‰ |
| **Safety** | 10 % | æœªæ³„éœ²å¯†é’¥ã€é‚®ç®±ã€å†…ç½‘åœ°å€ |

---

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

- **æµå¼è¾“å‡º**ï¼š
  ```bash
  npm run dev -- --stream
  ```

- **è‡ªå®šä¹‰æ•°æ®é›†**ï¼š
  æŠŠæ›´å¤š `{"diff":"...","ground_truth":"..."}` è¿½åŠ åˆ° `src/evaluate/dataset.jsonl` å³å¯è‡ªåŠ¨å‚ä¸è¯„åˆ†ã€‚

- **CI é—¨ç¦**ï¼š
  åœ¨ GitHub Actions é‡Œè°ƒç”¨ `npm run eval:compare`ï¼Œè‹¥ **style < 0.90 æˆ– semantic < 0.80** åˆ™æ‹’ç»åˆå¹¶ Prompt å˜æ›´ï¼Œç¤ºä¾‹è§ `.github/workflows/eval.yml`ã€‚

---

## ğŸ¤ å‚ä¸è´¡çŒ®

1. Fork + æ–°å»ºåˆ†æ”¯
2. æ”¹è¿› prompt æˆ–å¢åŠ æ¨¡å‹
3. è·‘é€š `npm run eval:compare` å¹¶æå‡æŒ‡æ ‡
4. æäº¤ PRï¼ŒCI ä¼šè‡ªåŠ¨è´´å‡ºå¯¹æ¯”æŠ¥å‘Š

---

**Happy Committing!** ğŸ‰
è®©æ¯ä¸€è¡Œæäº¤å†å²ï¼Œéƒ½åƒè¯—ä¸€æ ·å·¥æ•´ã€‚
